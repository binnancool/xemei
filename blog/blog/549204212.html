<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>struts2 动态方法调用 感叹号!</title></head><body><h1>struts2 动态方法调用 感叹号!</h1><div><p><strong><span style="font-size: 16px;">Struts2的动态方法调用(Dynamic method Invoc)概括起来有三种方式，下面介绍：</span></strong></p><p><strong><span style="background-color: #ffffff; color: #ff0000; font-size: 16px;">1、第一种方式：设置method属性</span></strong></p><p>在Action类中定义一个签名与execute方法相同、只是名字不同的方法，如定义为：</p><p>public String login() throws Exception{}</p><p>然后在struts.xml文件中加一个&lt;action&gt;元素，并设置它的method属性。代码如下（核心代码）：</p><p>&lt;action name=&quot;loginMethod&quot; </p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; class=&quot;com.polaris.LoginAction&quot; method=&quot;login&quot;&gt;</p><p>&lt;result&gt;/result.jsp&lt;/result&gt;</p><p>&lt;result name=&quot;error&quot;&gt;/error.jsp&lt;/result&gt;</p><p>&lt;/action&gt;</p><p>清单1：struts.xml部分内容</p><p>然后在JSP中表单的action设置为loginMethod。这样，Struts2就会去调用LoginAction中的loigin方法，而不会去调用execute()方法。</p><p><strong><span style="color: #ff0000; font-size: 16px;">2、第二种方式：改变表单的action的设置内容</span></strong></p><p>同第一种方式，定一个login方法。只是不需要改变struts.xml文件的内容。然后，在JSP页面中，设置表单的action为loginMethod!login.action。这样，Struts2也会去调用login方法，而不调用execute方法。其中，表单action=&quot;loginMethod!login.action&quot; 中，loginMethod为struts.xml文件中&lt;action&gt; 元素的name属性值，login.action中的login为Action类中的方法名。注意：login.action的action不能少。</p><p><strong><span style="color: #ff0000; font-size: 16px;">3、第三种方式：使用通配符</span></strong></p><p>首先同上面两种方式，定一个login方法，然后在struts.xml文件中配置如下内容：</p><p>&lt;action name=&quot;*Action&quot; </p><p>&nbsp;&nbsp; class=&quot;com.xuxinhua1984.struts2.i18n.LoginAction&quot; method=&quot;{1}&quot;&gt;</p><p>&lt;result name=&quot;success&quot;&gt;/success.jsp&lt;/result&gt;</p><p>&lt;result name=&quot;error&quot;&gt;/error.jsp&lt;/result&gt;</p><p>&lt;/action&gt;</p><p>清单2：struts.xml部分内容</p><p>然后在JSP页面中，设置表单的action为loginAction，此处login为Action类中的方法名，这样struts.xml中的*Action就可以和loginAction模糊匹配了，然后，method=&quot;{1}&quot;就相当于method=&quot;login&quot;。这样一来就回到了第一种方式。</p><p>另外，这种方式甚至结果类型对应的物理视图都可以用通配符。例如，如果想让登录失败后返回登录页，可以设置&lt;result name=&quot;error&quot;&gt;/{1}.jsp&lt;/result&gt;。这样，此处的{1}也会被*号实际的内容替代，此处为login，所以就转发回login.jsp页面了。</p><p>总结：对于以上三种方式，我个人建议使用第一、第二种方式，感觉第三种方式是比较灵活，但是也容易产生混乱，且容易出错。</p><p>Struts2支持动态方法调用，它指的是一个Action中有多个方法，系统根据表单元素给定的action来访问不同的方法，而不用写多个Action。</p><p><br /></p><p><br /></p><p>&nbsp; struts2中无需配置就可以直接调用Action中非execute方法的方式，就是试用struts2的动态动态方法调用。<br />动态方法调用(Dynamic method Invoc)是在action的名字中使用感叹号(!)来标示要调用的方法名，其语法格式为<br />&nbsp; actionName!methodname.action<br />例如我们的配置如下：<br />&lt;action name=&quot;login&quot; class=&quot;com.pj.action.LoginAction&quot;&gt;<br />&lt;result type=&quot;json&quot;&gt;&lt;/result&gt;<br />&lt;/action&gt;&nbsp;&nbsp; <br />当请求/login!query.action时,将调用LoginAction的query()方法，当请求/login!save.action时，将调用LoginAction的save()方法。</p><p><strong><span style="color: #ff0000; font-size: 16px;">备注</span><br /></strong>Strust2提供了一种配置，用于禁用DMI,你可以在struts.xml文件中，使用constant元素将struts.enable.DynamicMethodInvocation属性设置为false，来关闭DMI。 </p></div></body></html>