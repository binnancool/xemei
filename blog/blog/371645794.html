<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>linux 定时任务 crontab 详细解释</title><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- top1 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-3347102627476643"
     data-ad-slot="2352128818"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></head><body><h1>linux 定时任务 crontab 详细解释</h1><div><p>cron 是linux的内置服务，但它不自动起来，可以用以下的方法启动、关闭这个服务：&nbsp; <br>引用:&nbsp; <br>/sbin/service crond start //启动服务&nbsp; <br>/sbin/service crond stop //关闭服务&nbsp; <br>/sbin/service crond restart //重启服务&nbsp; <br>/sbin/service crond reload //重新载入配置&nbsp; </p>
<p>//=========================================================================</p>
<p># Use the hash sign to prefix a comment<br># +---------------- minute (0 - 59)<br># |&nbsp; +------------- hour (0 - 23)<br># |&nbsp; |&nbsp; +---------- day of month (1 - 31)<br># |&nbsp; |&nbsp; |&nbsp; +------- month (1 - 12)<br># |&nbsp; |&nbsp; |&nbsp; |&nbsp; +---- day of week (0 - 7) (Sunday=0 or 7)<br># |&nbsp; |&nbsp; |&nbsp; |&nbsp; |<br># *&nbsp; *&nbsp; *&nbsp; *&nbsp; *&nbsp; command to be executed</p>
<p>//=============================================================================</p>
<p><br>很多时候，你没有办法重新启动crond，这个时候可以先killall crond 然后再crond restart就哦ok了。<br>你也可以将这个服务在系统启动的时候也自动启动：&nbsp; <br>引用:&nbsp; <br>在/etc/rc.d/rc.local这个脚本的末尾加上：&nbsp; <br>/sbin/service crond start&nbsp; <br>现在cron这个服务已经在进程里面了，我们就可以用这个服务了，cron服务提供以下几种接口供大家使用：&nbsp; <br>1.直接用crontab命令编辑&nbsp; <br>cron服务提供crontab命令来设定cron服务的，以下是这个命令的一些参数与说明：&nbsp; <br>引用:&nbsp; <br>crontab -u //设定某个用户的cron服务，一般root用户在执行这个命令的时候需要此参数&nbsp; <br>crontab -l //列出某个用户cron服务的详细内容&nbsp; <br>crontab -r //删除没个用户的cron服务&nbsp; <br><strong><span style="BACKGROUND-COLOR: #ffffff; COLOR: #ff0000; FONT-SIZE: 16px">crontab -e //编辑某个用户的cron服务&nbsp; <span style="COLOR: #aa00ff"></span></span></strong></p>
<p><strong><span style="BACKGROUND-COLOR: #ffffff; COLOR: #ff0000; FONT-SIZE: 16px"><span style="COLOR: #aa00ff">文件所在位置：/var/spool/cron/root(其中root是用户名)</span></span></strong></p>
<p><strong><font color="#aa00ff" size="3">日志所在的文件：/var/log/cron</font><br></strong>比如说root查看自己的cron设置：&nbsp; <br>引用:&nbsp; <br>crontab -u root -l&nbsp; <br>再例如，root想删除fred的cron设置：&nbsp; <br>引用:&nbsp; <br>crontab -u fred -r&nbsp; <br>在编辑cron服务时，编辑的内容有一些格式和约定，输入：&nbsp; <br>引用:&nbsp; <br>crontab -u root -e&nbsp; <br>进入vi编辑模式，编辑的内容一定要符合下面的格式：&nbsp; <br>引用:&nbsp; <br>*/1 * * * * ls &gt;&gt; /tmp/ls.txt&nbsp; <br>这个格式的前一部分是对时间的设定，后面一部分是要执行的命令，如果要执行的命令太多，可以把这些命令写到一个脚本里面，然后在这里直接调用这个脚本就可 以了，调用的时候记得写出命令的完整路径。时间的设定我们有一定的约定，前面五个*号代表五个数字，数字的取值范围和含义如下：&nbsp; <br>引用:&nbsp; <br>分钟　（0-59）&nbsp; <br>小时　（0-23）&nbsp; <br>日期　（1-31）&nbsp; <br>月份　（1-12）&nbsp; <br>星期　（0-6）//0代表星期天&nbsp; <br>除了数字还有几个个特殊的符号就是"*"、"/"和"-"、","，*代表所有的取值范围内的数字，"/"代表每的意思,"*/5"表示每5个单位，"-"代表从某个数字到某个数字,","分开几个离散的数字。以下举几个例子说明问题：&nbsp; <br>引用:&nbsp; <br>每天早上6点&nbsp; <br>0 6 * * * echo "Good morning." &gt;&gt; /tmp/test.txt //注意单纯echo，从屏幕上看不到任何输出，因为cron把任何输出都email到root的信箱了。&nbsp; <br>每两个小时&nbsp; <br>0 */2 * * * echo "Welcome to <a href="http://beyl.cn/">http://beyl.cn</a>." &gt;&gt; /tmp/test.txt&nbsp; <br>晚上11点到早上8点之间每两个小时，早上八点&nbsp; <br>0 23-7/2，8 * * * echo "Welcome to <a href="http://beyl.cn/">http://beyl.cn</a>.：）" &gt;&gt; /tmp/test.txt&nbsp; <br>每个月的4号和每个礼拜的礼拜一到礼拜三的早上11点&nbsp; <br>0 11 4 * 1-3 command line&nbsp; <br>1月1日早上4点&nbsp; <br>0 4 1 1 * command line&nbsp; <br>每次编辑完某个用户的cron设置后，cron自动在/var/spool/cron下生成一个与此用户同名的文件，此用户的cron信息都记录在这个文 件中，这个文件是不可以直接编辑的，只可以用crontab -e 来编辑。cron启动后每过一份钟读一次这个文件，检查是否要执行里面的命令。因此此文件修改后不需要重新启动cron服务。&nbsp; <br>2.编辑/etc/crontab 文件配置cron&nbsp; <br>cron 服务每分钟不仅要读一次/var/spool/cron内的所有文件，还需要读一次/etc/crontab,因此我们配置这个文件也能运用cron服务 做一些事情。用crontab配置是针对某个用户的，而编辑/etc/crontab是针对系统的任务。此文件的文件格式是：&nbsp; <br>引用:&nbsp; <br>SHELL=/bin/bash&nbsp; <br>PATH=/sbin:/bin:/usr/sbin:/usr/bin&nbsp; <br>MAILTO=root //如果出现错误，或者有数据输出，数据作为邮件发给这个帐号&nbsp; <br>HOME=/&nbsp; <br># run-parts&nbsp; <br>01 * * * * root run-parts /etc/cron.hourly //每个小时去执行一遍/etc/cron.hourly内的脚本&nbsp; <br>02 4 * * * root run-parts /etc/cron.daily //每天去执行一遍/etc/cron.daily内的脚本&nbsp; <br>22 4 * * 0 root run-parts /etc/cron.weekly //每星期去执行一遍/etc/cron.weekly内的脚本&nbsp; <br>42 4 1 * * root run-parts /etc/cron.monthly //每个月去执行一遍/etc/cron.monthly内的脚本&nbsp; <br>使用者 运行的路径&nbsp; <br>大家注意"run-parts"这个参数了，如果去掉这个参数的话，后面就可以写要运行的某个脚本名，而不是文件夹名了。&nbsp; <br>cron&nbsp; <br>定时执行指令 ( cron )：&nbsp; <br>crontab [*/Minute] [*/Hour] [*/Day] [*/Month] [*(/DayOfWeek)?] Command&nbsp; <br>Minute: 分钟，1 ~ 59&nbsp; <br>Hour : 小时，0 ~ 23&nbsp; <br>Day : 日期，1 ~ 31&nbsp; <br>Month : 月份，1 ~ 12 或 jan、feb...&nbsp; <br>DayOfWeek? : 0（星期日）~ 6（星期六），或 mon、tue...&nbsp; <br>Command : 所要执行的指令，中间以 ; 来分隔多个指令。&nbsp; <br>&nbsp; <br>-e : 编辑 /var/spool/cron/crontabs/UserName 这一个档案。以 # 开头代表批注。&nbsp; <br>-l : 列出 /var/spool/cron/crontabs/UserName 这一个档案的内容。&nbsp; <br>-d : 删除使用者的工作排程。&nbsp; <br>-r : 删除使用者的工作排程档。&nbsp; <br>&nbsp; <br>Minute，Houre，Day，Month，DayOfWeek? 为条件式，需要符合所有条件的那个时刻指令才会执行。&nbsp; <br>用 * 来代表略过这一个条件。&nbsp; <br>如果同一个字段有多个条件，中间要用 , 分开。&nbsp; <br>如果是指连续一段时间，中间则以 - 分开。&nbsp; <br>如果要每隔固定时间执行，则使用 /#，指每隔 # 时刻执行。&nbsp; <br>&nbsp; <br>crontab 的指令，预设是以 /bin/sh 为直译器，而以使用者的家目录为工作目录。然而使用者可以用 HOME、SHELL、PATH 的变量改变执行时的直译器、预设执行目录与路径。也可以透过设定 MAILTO 设定执行后的纪录要以电子邮件记送到何处。&nbsp; <br># use /bin/sh to run commands, no matter what /etc/passwd says&nbsp; <br>SHELL=/bin/sh&nbsp; <br># mail any output to `paul', no matter whose crontab this is&nbsp; <br>MAILTO=paul&nbsp; <br>#&nbsp; <br># run five minutes after midnight, every day&nbsp; <br>5 0 * * * $HOME/bin/daily.job &gt;&gt; $HOME/tmp/out 2&gt;&amp;1&nbsp; <br># run at 2:15pm on the first of every month -- output mailed to paul&nbsp; <br>15 14 1 * * $HOME/bin/monthly&nbsp; <br># run at 10 pm on weekdays, annoy Joe&nbsp; <br>0 22 * * 1-5 mail -s "It's 10pm" joe%Joe,%%Where are your kids?%&nbsp; <br>23 0-23/2 * * * echo "run 23 minutes after midn, 2am, 4am ..., everyday"&nbsp; <br>5 4 * * sun echo "run at 5 after 4 every sunday"&nbsp; <br>root 可以用 -u user name 来编辑其它使用者的 crontab 设定。&nbsp; <br>crontab -u UserName -e&nbsp; <br>&nbsp; <br>在开机时，rc 档会载入 crond 这一个 Daemon，&nbsp; <br>它会定时去读取这个档案，并依其内容执行指令。&nbsp; <br>而指令的执行结果（标准输出／错误输出，stdout/stderr）会以邮件方式寄给系统管理者，&nbsp; <br>即 /etc/aliases 档案中的 root : UserName 。&nbsp; <br>&nbsp; <br>也可以先将指令储存成档案，然后使用&nbsp; <br>crontab FileName&nbsp; <br>来将要执行的指令写入 /var/spool/cron/crontabs/UserName 这一个档案中</p>
<p>&nbsp;</p>
<p>本文来自CSDN博客，转载请标明出处：<a href="http://blog.csdn.net/ancky_zhang/archive/2009/03/03/3952194.aspx">http://blog.csdn.net/ancky_zhang/archive/2009/03/03/3952194.aspx</a></p></div></body></html>