<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>windows xp 定时执行任务之二——schtasks</title><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- top1 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-3347102627476643"
     data-ad-slot="2352128818"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></head><body><h1>windows xp 定时执行任务之二——schtasks</h1><div><div class="item-content">更改计划任务
<p align="left"><a name="change"></a>更改一个或多个下列任务属性。</p>
<ul>
    <li>任务运行的程序 (<strong>/tr</strong>)。</li>
    <li>任务运行的用户帐户 (<strong>/ru</strong>)。</li>
    <li>用户帐户的密码 (<strong>/rp</strong>)。</li>
</ul>
<p align="left"><strong>语法</strong></p>
<p align="left"><strong>schtasks/change/tn</strong><em>TaskName</em>[<strong>/s</strong><em>computer</em>[<strong>/u</strong>[<em>domain</em>\]<em>user</em><strong>/p</strong><em>password</em>]][<strong>/tr</strong><em>TaskRun</em>][<strong>/ru</strong>[<em>Domain</em>\]<em>User</em>|<strong>&quot;System&quot;</strong>][<strong>/rp</strong><em>Password</em>]</p>
<p align="left"><strong>参数</strong></p>
<p align="left"><strong>/tn</strong><em>TaskName</em></p>
<p align="left">标识要更改的任务。输入任务名。</p>
<p align="left"><strong>/s</strong><em>Computer</em></p>
<p align="left">指定远程计算机的名称或 IP 地址（带有或者没有反斜杠）。默认值是本地计算机。</p>
<p align="left"><strong>/u</strong>[<em>domain</em>\]<em>user</em></p>
<p align="left">使用特定用户帐户的权限运行命令。默认情况下，使用已登录到运行 SchTasks 的计算机上的用户的权限运行命令。</p>
<p align="left"><strong>/p</strong><em>password</em></p>
<p align="left">指定在<strong>/u</strong>参数中指定的用户帐户的密码。如果使用<strong>/u</strong>参数，则需要该参数。</p>
<p align="left"><strong>/tr</strong><em>TaskRun</em></p>
<p align="left">更改任务运行的程序。输入可执行文件、脚本文件或批处理文件的完全合格的路径和文件名。如果忽略了路径，SchTasks.exe 假定文件在<em>Systemroot</em>\System32 目录下指定的程序替换任务最初运行的程序。</p>
<p align="left"><strong>/ru</strong>[<em>Domain</em>\]<em>User</em>|<strong>&quot;System&quot;</strong></p>
<p align="left">更改用于任务的用户帐户。</p>
<div align="center">
<table border="1" cellpadding="0">
    <tbody>
        <tr>
            <td>
            <p align="left"><strong>值</strong></p>
            </td>
            <td>
            <p align="left"><strong>说明</strong></p>
            </td>
        </tr>
        <tr>
            <td>
            <p align="left">[<em>domain</em>\]<em>User</em></p>
            </td>
            <td>
            <p align="left">指定用户帐户</p>
            </td>
        </tr>
        <tr>
            <td>
            <p align="left"><strong>&quot;System&quot;</strong>or<strong>&quot;&quot;</strong></p>
            </td>
            <td>
            <p align="left">指定为操作系统所使用的 NT Authority\System 帐户。</p>
            </td>
        </tr>
    </tbody>
</table>
</div>
<p align="left">在更改用户帐户的时候，必须也要更改用户密码。如果命令带有<strong>/ru</strong>参数，但没有<strong>/rp</strong>参数，SchTasks.exe 提示要求输入新的密码而且不显示键入的文本。</p>
<p align="left">任务以不需要密码的 NT Authority\System 帐户权限运行，SchTasks.exe 不会提示输入密码。</p>
<p align="left"><strong>/p</strong><em>Password</em></p>
<p align="left">更改用于任务的帐户密码。输入新的密码。</p>
<p align="left"><strong>/?</strong></p>
<p align="left">在命令提示符显示帮助。</p>
<p align="left"><strong>注释</strong></p>
<p align="left">XOX</p>
<ul>
    <li><strong>/tn</strong>和<strong>/s</strong>参数标识该任务。<strong>/tr</strong>、<strong>/ru</strong>和<strong>/rp</strong>参数指定可以更改的任务属性。</li>
    <li>使用<strong>change</strong>操作的命令必须至少更改一个任务属性。</li>
    <li>NT Authority\System 帐户没有交互式登录权限。用户看不到以系统权限运行的程序，不能与其交互。</li>
</ul>
<p align="left"><strong>范例</strong></p>
<p align="left"><strong>更改任务运行的程序</strong></p>
<p align="left">下面的命令将 Virus Check 任务运行的程序由 VirusCheck.exe 更改为 VirusCheck2.exe。此命令使用<strong>/tn</strong>参数标识任务，使用<strong>/tr</strong>参数指定任务的新程序。（不能更改任务名称。）</p>
<p align="left"><strong>schtasks /change /tn &quot;Virus Check&quot; /tr C:\VirusCheck2.exe</strong></p>
<p align="left">作为响应，SchTasks.exe 显示以下成功消息：</p>
<p align="left">成功：计划任务 &quot;Virus Check&quot; 的参数已更改。</p>
<p align="left">此命令的结果是，Virus Check 任务现运行 VirusCheck2.exe。</p>
<p align="left"><strong>更改远程任务的用户密码</strong></p>
<p align="left">下面的命令更改用于远程计算机 Svr01 上 RemindMe 任务的用户帐户密码。命令使用<strong>/tn</strong>参数标识任务，使用<strong>/s</strong>参数指定远程计算机。它使用<strong>/rp</strong>参数指定新的密码 p@ssWord3。</p>
<p align="left">在用户帐户密码过期或更改的时候需要此过程。如果存储在任务中的密码无效，那么任务不会运行。</p>
<p align="left"><strong>schtasks /change /tn RemindMe /s Svr01 /rp p@ssWord3</strong></p>
<p align="left">作为响应，SchTasks.exe 显示以下成功消息：</p>
<p align="left">成功：计划任务 &quot;RemindMe&quot; 的参数已更改。</p>
<p align="left">这个命令的结果是，RemindMe 任务现在以其初始的用户帐户运行，但拥有一个新密码。</p>
<p align="left"><strong>更改任务的程序和用户帐户</strong></p>
<p align="left">下面的命令更改任务运行的程序以及任务运行的用户帐户。实质上，它将旧的计划用于新的任务。这个命令将每天早上 9:00 a.m. 启动 &quot;Notepad.exe&quot; 的 Notepad 任务更改为启动 &quot;Internet Explorer&quot;。</p>
<p align="left">该命令使用<strong>/tn</strong>参数来标识任务。它使用<strong>/tr</strong>参数更改任务运行的程序，使用<strong>/ru</strong>参数更改任务运行凭据的用户帐户。</p>
<p align="left">忽略为用户帐户提供密码的<strong>/rp</strong>参数。必须为帐户提供密码，但可以使用<strong>/rp</strong>参数以及在明文中键入密码，或等待 SchTasks.exe 要求输入密码的提示，然后以不显示文本的方式输入密码。</p>
<p align="left"><strong>schtasks /change /tn Notepad /tr &quot;c:\program files\Internet Explorer\iexplore.exe&quot; /ru DomainX\Admin01</strong></p>
<p align="left">作为响应，SchTasks.exe 索要用于用户帐户的密码。它不显示键入的文本，因此密码不可见。</p>
<p align="left">Please enter the password for DomainX\Admin01:<strong>*********</strong></p>
<p align="left">请注意，<strong>/tn</strong>参数标识任务，<strong>/tr</strong>和<strong>/ru</strong>参数更改任务的属性。不能使用另外一个参数来标识任务，而且不能更改任务的名称。</p>
<p align="left">作为响应，SchTasks.exe 显示以下成功消息：</p>
<p align="left">成功：计划任务 &quot;Notepad&quot; 的参数已更改。</p>
<p align="left">这个命令的结果是：RemindMe 任务现在以其初始的用户帐户运行，但拥有一个新密码。</p>
<p align="left"><strong>将程序更改为</strong><strong> System </strong><strong>帐户</strong></p>
<p align="left">下面的命令更改了 Securityscrīpt 任务以使其以 NT Authority\System 帐户权限运行。它使用<strong>/ru &quot;&quot;</strong>参数来表示 System 帐户。</p>
<p align="left"><strong>schtasks /change /tn Securityscrīpt /ru &quot;&quot;</strong></p>
<p align="left">作为响应，SchTasks.exe 显示以下成功消息：</p>
<p align="left">成功：计划任务 &quot;Securityscrīpt&quot; 的参数已更改。</p>
<p align="left">因为任务以 System 帐户权限运行不需要密码，所以 SchTasks.exe 不提示输入密码。</p>
<p align="left">schtasks run</p>
<p align="left"><a name="run"></a>立即运行计划任务。<strong>run</strong>操作忽略计划，但使用程序文件位置、用户帐户和存储在任务中的密码立即运行任务。</p>
<p align="left"><strong>语法</strong></p>
<p align="left"><strong>schtasks/run/tn</strong><em>TaskName</em>[<strong>/s</strong><em>computer</em>[<strong>/u</strong>[<em>domain</em>\]<em>user</em><strong>/p</strong><em>password</em>]]<strong>/?</strong></p>
<p align="left"><strong>参数</strong></p>
<p align="left"><strong>/tn</strong><em>TaskName</em></p>
<p align="left">标识任务。该参数是必需的。</p>
<p align="left"><strong>/s</strong><em>Computer</em></p>
<p align="left">指定远程计算机的名称或 IP 地址（带有或者没有反斜杠）。默认值是本地计算机。</p>
<p align="left"><strong>/u</strong>[<em>domain</em>\]<em>user</em></p>
<p align="left">使用特定用户帐户的权限运行命令。默认情况下，使用已登录到运行 SchTasks 的计算机上的用户的权限运行命令。</p>
<p align="left"><strong>/p</strong><em>password</em></p>
<p align="left">指定在<strong>/u</strong>参数中指定的用户帐户的密码。如果使用<strong>/u</strong>参数，则需要该参数。</p>
<p align="left"><strong>/?</strong></p>
<p align="left">在命令提示符显示帮助。</p>
<p align="left"><strong>注释</strong></p>
<p align="left">XOX</p>
<ul>
    <li>使用这个操作来测试任务。如果任务没有运行，请检查&ldquo;任务计划程序服务&rdquo;事务日志<em>Systemroot</em>\SchedLgU.txt 以获取错误。</li>
    <li>运行任务不会影响任务计划，不会更改为任务计划好的下次运行时间。</li>
    <li>要远程运行任务，必须在远程计算机上计划任务。在运行该任务时，它仅在远程计算机上运行。要验证任务正在远程计算机上运行，请使用&ldquo;任务管理器&rdquo;或&ldquo;任务计划程序&rdquo;事务日志<em>Systemroot</em>\SchedLgU.txt。</li>
</ul>
<p align="left"><strong>范例</strong></p>
<p align="left"><strong>在本地计算机上运行任务</strong></p>
<p align="left">下面的命令启动 &quot;Security scrīpt&quot; 任务。</p>
<p align="left"><strong>schtasks /run /tn &quot;Security scrīpt&quot;</strong></p>
<p align="left">作为响应，SchTasks.exe 启动与任务相关联的脚本并显示以下消息：</p>
<p align="left">成功：计划任务 &quot;Security scrīpt&quot; 正在运行 ...</p>
<p align="left"><strong>在远程计算机上运行任务</strong></p>
<p align="left">下面的命令在远程计算机 Svr01 上运行 Update 任务：</p>
<p align="left"><strong>schtasks /run /tn Update /s Svr01</strong></p>
<p align="left">此时，SchTasks.exe 显示以下错误消息：</p>
<p align="left">错误:无法运行计划任务 &quot;Update&quot;。</p>
<p align="left">查看 Svr01 上的 &ldquo;计划任务程序&rdquo;事务日志 C:\Windows\SchedLgU.txt 以获取错误的原因。在这种情况下，日志中显示以下条目：</p>
<p align="left">&quot;Update.job&quot; (update.exe) 3/26/2001 1:15:46 PM ** ERROR **</p>
<p align="left">The attempt to log on to the account associated with the task failed, therefore, the task did not run.</p>
<p align="left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   The specific error is</p>
<p align="left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  0x8007052e:Logon failure:unknown user name or bad password.</p>
<p align="left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Verify that the task's Run-as name and password are valid and try again.</p>
<p align="left">显然，任务中的用户名或密码在此系统中无效。下面的<strong>schtasks /change</strong>命令为 Svr01 上的 Update 任务更新用户名和密码：</p>
<p align="left"><strong>schtasks /change /tn Update /s Svr01 /ru Administrator /rp PassW@rd3</strong></p>
<p align="left">在<strong>change</strong>命令完成之后，重新运行<strong>run</strong>命令。这一次，Update.exe 程序启动，SchTasks.exe 显示以下消息：</p>
<p align="left">错误：无法运行计划任务 &quot;Update&quot;。</p>
<p align="left">schtasks end</p>
<p align="left"><a name="end"></a>终止由任务启动的程序</p>
<p align="left"><strong>语法</strong></p>
<p align="left"><strong>schtasks/end/tn</strong><em>TaskName</em>[<strong>/s</strong><em>computer</em>[<strong>/u</strong>[<em>domain</em>\]<em>user</em><strong>/p</strong><em>password</em>]]<strong>/?</strong></p>
<p align="left"><strong>参数</strong></p>
<p align="left"><strong>/tn</strong><em>TaskName</em></p>
<p align="left">标识启动程序的任务。该参数是必需的。</p>
<p align="left"><strong>/s</strong><em>Computer</em></p>
<p align="left">指定远程计算机（带有或者没有反斜杠）的名称或 IP 地址。默认值是本地计算机。</p>
<p align="left"><strong>/u</strong>[<em>domain</em>\]<em>user</em></p>
<p align="left">使用特定用户帐户的权限运行命令。默认情况下，使用已登录到运行 SchTasks 的计算机上的用户的权限运行命令。</p>
<p align="left"><strong>/p</strong><em>password</em></p>
<p align="left">指定在<strong>/u</strong>参数中指定的用户帐户的密码。如果使用<strong>/u</strong>参数，则需要该参数。</p>
<p align="left"><strong>/?</strong></p>
<p align="left">显示帮助。</p>
<p align="left"><strong>注释</strong></p>
<p align="left">XOX</p>
<ul>
    <li>SchTasks.exe 只终止由计划任务启动的程序实例。要终止其它程序，请使用 TaskKill。它是一个包含在 Windows XP Professional 中的工具。有关 TaskKill 的详细信息，请参阅 TaskKill。</li>
</ul>
<p align="left"><strong>范例</strong></p>
<p align="left"><strong>终止本地计算机上的任务</strong></p>
<p align="left">下面的命令终止由 My Notepad 任务启动的 Notepad 实例：</p>
<p align="left"><strong>schtasks /end /tn &quot;My Notepad&quot;</strong></p>
<p align="left">作为响应，SchTasks.exe 终止了由任务启动的 Notepad 实例并显示以下成功消息：</p>
<p align="left">成功：计划任务 &quot;My Notepad&quot; 已成功终止。</p>
<p align="left"><strong>终止远程计算机上的任务</strong></p>
<p align="left">下面的命令终止远程计算机 Svr01 上由 InternetOn 任务启动的 Internet Explorer 实例：</p>
<p align="left"><strong>schtasks /end /tn InternetOn /s Svr01</strong></p>
<p align="left">作为响应，SchTasks.exe 停止由任务启动的 Internet Explorer 实例并显示以下成功消息：</p>
<p align="left">成功：计划任务 &quot;Update&quot; 正在运行...</p>
<p align="left">schtasks delete</p>
<p align="left">删除计划任务</p>
<p align="left"><strong>语法</strong></p>
<p align="left"><strong>schtasks/delete/tn</strong>{<em>TaskName</em>| *}[<strong>/f</strong>][<strong>/s</strong><em>computer</em>[<strong>/u</strong>[<em>domain</em>\]<em>user</em><strong>/p</strong><em>password</em>]][<strong>/?</strong>]</p>
<p align="left"><strong>参数</strong></p>
<p align="left"><strong>/tn</strong>{<em>TaskName</em>| *}</p>
<p align="left">标识要删除的任务。该参数是必需的。</p>
<div align="center">
<table border="1" cellpadding="0">
    <tbody>
        <tr>
            <td>
            <p align="left"><strong>值</strong></p>
            </td>
            <td>
            <p align="left"><strong>说明</strong></p>
            </td>
        </tr>
        <tr>
            <td>
            <p align="left"><em>TaskName</em></p>
            </td>
            <td>
            <p align="left">删除已命名任务。</p>
            </td>
        </tr>
        <tr>
            <td>
            <p align="left"><em>*</em></p>
            </td>
            <td>
            <p align="left">删除计算机上的所有计划任务。</p>
            </td>
        </tr>
    </tbody>
</table>
</div>
<p align="left"><strong>/f</strong></p>
<p align="left">阻止确认消息。不警告就删除任务。</p>
<p align="left"><strong>/s</strong><em>Computer</em></p>
<p align="left">指定远程计算机的名称或 IP 地址（带有或者没有反斜杠）。默认值是本地计算机。</p>
<p align="left"><strong>/u</strong>[<em>domain</em>\]<em>user</em></p>
<p align="left">使用特定用户帐户的权限运行命令。默认情况下，使用已登录到运行 SchTasks 的计算机上的用户的权限运行命令。</p>
<p align="left"><strong>/p</strong><em>password</em></p>
<p align="left">指定在<strong>/u</strong>参数中指定的用户帐户的密码。如果使用<strong>/u</strong>参数，则需要该参数。</p>
<p align="left"><strong>/?</strong></p>
<p align="left">在命令提示符显示帮助。</p>
<p align="left"><strong>注释</strong></p>
<p align="left">XOX</p>
<ul>
    <li><strong>delete</strong>操作从计划表中删除任务。它不删除任务运行的程序或中断正在运行的程序。</li>
    <li><strong>delete *</strong>命令删除所有为计算机计划的任务，而不是仅删除由当前用户计划的任务。</li>
</ul>
<p align="left"><strong>范例</strong></p>
<p align="left"><strong>从远程计算机上的计划表中删除任务</strong></p>
<p align="left">下面的命令从远程计算机上的计划表中删除 &quot;Start Mail&quot; 任务。它使用<strong>/s</strong>参数来标识远程计算机。</p>
<p align="left"><strong>schtasks /delete /tn &quot;Start Mail&quot; /s Svr16</strong></p>
<p align="left">作为响应， SchTasks.exe 显示以下确认消息。要删除任务，请键入<strong>y</strong>。要取消命令，请键入<strong>n</strong>：</p>
<p align="left">警告您确定要删除任务 &quot;Start Mail&quot; 吗 (Y/N )?<strong>y</strong>成功:已成功删除计划任务 &quot;Start Mail&quot;。</p>
<p align="left"><strong>删除所有为本地计算机计划的任务。</strong></p>
<p align="left">下面的命令从本地计算机的计划表中删除所有的任务，包括由其它用户计划的任务。它使用<strong>/tn *</strong>参数代表计算机上所有的任务，使用<strong>/f</strong>参数取消确认消息。</p>
<p align="left"><strong>schtasks /delete /tn * /f</strong></p>
<p align="left">作为响应，SchTasks.exe 显示以下成功消息以表明只删除了计划任务 Securescrīpt。</p>
<p align="left">成功：计划任务 &quot;Securescrīpt&quot; 已成功删除。</p>
<p align="left">schtasks query</p>
<p align="left">显示计划在计算机上运行的所有任务，包括那些由其它用户计划的任务。</p>
<p align="left"><strong>语法</strong></p>
<p align="left"><strong>schtasks</strong>[<strong>/query</strong>][<strong>/fo</strong>{<strong>TABLE</strong>|<strong>LIST</strong>|<strong>CSV</strong>}][<strong>/nh</strong>][<strong>/v</strong>][<strong>/s</strong><em>computer</em>[<strong>/u</strong>[<em>domain</em>\]<em>user</em><strong>/p</strong><em>password</em>]]</p>
<p align="left"><strong>参数</strong></p>
<p align="left">[<strong>/query</strong>]</p>
<p align="left">操作名称可选。键入不带任何参数的<strong>schtasks</strong>来执行查询。</p>
<p align="left"><strong>/fo</strong>{<strong>TABLE</strong>|<strong>LIST</strong>|<strong>CSV</strong>}</p>
<p align="left">指定输出格式。<strong>TABLE</strong>为默认值。</p>
<p align="left"><strong>/nh</strong></p>
<p align="left">忽略表格显示中的列标题。此参数与<strong>TABLE</strong>和<strong>CSV</strong>输出格式共同使用时有效。</p>
<p align="left"><strong>/v</strong></p>
<p align="left">将任务的高级属性添加到显示中。</p>
<p align="left">使用<strong>/v</strong>的查询应该格式化成<strong>LIST</strong>或<strong>CSV</strong>。</p>
<p align="left"><strong>/s</strong><em>Computer</em></p>
<p align="left">指定远程计算机的名称或 IP 地址（带有或者没有反斜杠）。默认值是本地计算机。</p>
<p align="left"><strong>/u</strong>[<em>domain</em>\]<em>user</em></p>
<p align="left">使用特定用户帐户的权限运行命令。默认情况下，使用已登录到运行 SchTasks 的计算机上的用户的权限运行命令。</p>
<p align="left"><strong>/p</strong><em>password</em></p>
<p align="left">指定在<strong>/u</strong>参数中指定的用户帐户的密码。如果使用<strong>/u</strong>参数，则需要该参数。</p>
<p align="left"><strong>/?</strong></p>
<p align="left">在命令提示符显示帮助。</p>
<p align="left"><strong>注释</strong></p>
<p align="left">XOX</p>
<ul>
    <li><strong>query</strong>操作列出了为计算机计划的所有任务，而不只是由当前用户计划的任务。</li>
</ul>
<p align="left"><strong>范例</strong></p>
<p align="left"><strong>显示本地计算机上的计划任务。</strong></p>
<p align="left">下面的命令显示为本地计算机计划的所有任务。这些命令得到的结果相同，并可以交换使用。</p>
<p align="left"><strong>schtasks</strong></p>
<p align="left"><strong>schtasks /query</strong></p>
<p align="left">作为响应，SchTasks.exe 以默认的简单表格格式显示任务，如下表所示：</p>
<p align="left">TaskName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Next Run Time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Status</p>
<p align="left">========================= ======================== ==============</p>
<p align="left">Microsoft Outlook&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  At logon time</p>
<p align="left">Securescrīpt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  14:42:00 PM ， 2/4/2001</p>
<p align="left"><strong>显示计划任务的高级属性</strong></p>
<p align="left">下面的命令要求详细的显示本地计算机上的任务。它使用<strong>/v</strong>参数来请求详细显示，使用<strong>/fo LIST</strong>参数来将显示格式化成易于阅读的列表。这个命令可以用来验证创建的任务有预期的循环模式。</p>
<p align="left"><strong>schtasks /query /fo LIST /v</strong></p>
<p align="left">作为响应，SchTasks.exe 显示所有任务的详细属性列表。下面的显示给出了一个计划在每月最后一个周五的 4:00 A.M. 运行的任务的列表：</p>
<p align="left">HostName：RESKIT01</p>
<p align="left">TaskName:Securescrīpt</p>
<p align="left">Next Run Time：4:00:00 AM ， 3/30/2001</p>
<p align="left">Status:Not yet run</p>
<p align="left">Last Run Time：Never</p>
<p align="left">Last Result：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  0</p>
<p align="left">Creator：user01</p>
<p align="left">Schedule：At 4:00 AM on the last Fri of every month, starting 3/24/2001</p>
<p align="left"> Task To Run:： C:\WINDOWS\system32\notepad.exe</p>
<p align="left"> Start In:notepad.exe</p>
<p align="left"> Comment:N/A</p>
<p align="left"> Scheduled Task State:Enabled</p>
<p align="left">Scheduled Type：Monthly</p>
<p align="left">Modifier：Last FRIDAY</p>
<p align="left">Start Time4:00:00 AM</p>
<p align="left">Start Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  3/24/2001</p>
<p align="left">End Date：N/A</p>
<p align="left">Days:FRIDAY</p>
<p align="left">Months:JAN、FEB、MAR、APR、MAY、JUN、JUL、AUG、SEP、OCT、NOV、DEC</p>
<p align="left">Run As User:RESKIT\user01</p>
<p align="left">Delete Task If Not Rescheduled:Enabled</p>
<p align="left">Stop Task If Runs X Hours and X Mins:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  72:0</p>
<p align="left">Repeat:Until Time：Disabled</p>
<p align="left">Repeat:Repeat:Disabled</p>
<p align="left">Repeat:Stop If Still Running: Disabled</p>
<p align="left">Idle: Start Time(For IDLE Scheduled Type): Disabled</p>
<p align="left">Idle: Only Start If Idle for X Minutes: Disabled</p>
<p align="left">Idle:If Not Idle Retry For X Minutes: Disabled</p>
<p align="left">Idle: Stop Task If Idle State End: Disabled</p>
<p align="left">Power Mgmt: No Start On Batteries: Disabled</p>
<p align="left">Power Mgmt:Stop On Battery Mode: Disabled</p>
<p align="left"><strong>将为远程计算机计划的任务记入日志</strong></p>
<p align="left">下面的命令请求为远程计算机计划的任务列表，并将任务添加到本地计算机中以逗号分隔的日志文件中。此命令的格式可以用来收集和跟踪为多个计算机计划的任务。</p>
<p align="left">命令使用<strong>/s</strong>参数标识远程计算机 Reskit16，使用<strong>/fo</strong>参数指定格式，使用<strong>/nh</strong>参数取消列标题。<strong>&gt;&gt;</strong>附加符号将输出重定向到本地计算机 Svr01 上的任务日志 p0102.csv。因为命令在远程计算机上运行，所以本地计算机路径必须是完全合格的。</p>
<p align="left"><strong>schtasks /query /s Reskit16 /fo csv /nh &gt;&gt; \\svr01\data\tasklogs\p0102.csv</strong></p>
<p align="left">作为响应，SchTasks.exe 会把为计算机 Reskit16 计划的任务添加到本地计算机 Svr01 上的 p0102.csv 文件中。</p>
<p align="left"><strong>注释</strong></p>
<ul>
    <li>SchTasks.exe 执行的操作类似于&ldquo;控制面板&rdquo;中&ldquo;计划任务&rdquo;中的操作。可以使用两种工具中的任一种来创建、删除、配置或显示计划任务。</li>
    <li>键入不带任何参数的<strong>schtasks</strong>执行查询。</li>
    <li>用户必须是命令起作用的计算机上的 Administrators 组的成员。</li>
    <li>要确认计划运行或要找出计划不运行的原因，请查看&ldquo;任务计划&rdquo;服务事务日志<em>Systemroot</em>\SchedLgU.txt。该日志记录了由包括&ldquo;计划任务&rdquo;和 SchTasks.exe 在内的所有使用该服务的工具启动的尝试运行。</li>
    <li>损坏任务文件的情况极少发生。已损坏文件不会运行。在已损坏任务上试图执行某项操作时，SchTasks.exe 显示以下错误消息：</li>
</ul>
<p align="left">错误：数据非法。</p>
<p align="left">已损坏任务无法恢复。要恢复系统的计划任务特征，请使用 SchTasks.exe 或&ldquo;计划任务&rdquo;从系统中删除任务并重新计划。</p>
SchTasks.exe 取代了包含在 Windows 早期版本中的工具</div></div></body></html>