<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>漫谈短信</title></head><body><h1>漫谈短信</h1><div><span>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; text-align: center" align="center"><strong style="mso-bidi-font-weight: normal"><span style=" mso-ascii- mso-hansi-">一、短信的基本属性</span><span><font face="Times New Roman">: </font></span></strong></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt"><span><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;  </span><strong style="mso-bidi-font-weight: normal"><span style="mso-spacerun: yes"> </span>SMS</strong></font></span><strong style="mso-bidi-font-weight: normal"><span style=" mso-ascii- mso-hansi-">（</span><span><font face="Times New Roman">Short Messaging Service</font></span></strong><strong style="mso-bidi-font-weight: normal"><span style=" mso-ascii- mso-hansi-">）根据其收发源，可以分为二种，即</span><span><font face="Times New Roman">MO</font></span></strong><strong style="mso-bidi-font-weight: normal"><span style=" mso-ascii- mso-hansi-">和</span><span><font face="Times New Roman">MT</font></span></strong><strong style="mso-bidi-font-weight: normal"><span style=" mso-ascii- mso-hansi-">短信：</span><span><font face="Times New Roman"> </font></span></strong></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt"><span><span style="mso-spacerun: yes"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;  </font></span></span><span>一种为<span>MO(Mobile Originate)</span>短信，即终端发起的，<span> </span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt"><span><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;  </span></span><span>一种为<span>MT(Mobile Terminated)</span>短信，即终端接收的，这里终端是相对网络设备而言，可以理解为手机，在网络中称为<span>SME(</span>短消息实体<span>)</span>；因此，如果是<span>SP</span>发送给手机的一条短信，则称为<span>MT</span>短信，反之则称为<span>MO</span>短信。<span> </span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; text-indent: 21.1pt; mso-char-indent-count: 2.0"><strong style="mso-bidi-font-weight: normal"><span style=" mso-ascii- mso-hansi-">根据其发送的格式，可以分为普通文本短信和二进制短信：</span><font face="Times New Roman"> <span></span></font></strong></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt"><span><span style="mso-spacerun: yes"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;  </font></span></span><span>普通文本短信就是我们一般收发的文字短信，在采用<span>GBK</span>编码发送含有中文字符的短信时，长度不超过<span>70</span>个字符；<span> </span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt"><span>　<span><span style="mso-spacerun: yes">  </span></span>而二进制短信，可以理解为控制信息；如让手机接收彩信时的<span>mms notify</span>信息、或将<span>wap</span>站点地址发送<span>(push)</span>到手机上的<span>wap link</span>信息、或将一个程序下载安装地址发送到用户手机上。二进制短信可以发送长度<span>170</span>个字符的<span>ASCLL</span>代码表示；二进制短信的一个短点是：手机接收到会有一个解码的过程，解码的结果未必是持机人可见的，例如<span>wappush</span>信息解码后就是一个<span>http</span>地址，用户点击后手机就会通过<span>gprs</span>网络登陆<span>wap</span>网站；而<span>mms notify</span>信息解码后，手机会在用户不知情的情况下，自动从网络上下载彩信内容<span>---</span>除非手机有特别设置；后一种可能为手机黑客的出现提供了机会。<span> </span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; text-indent: 15.75pt; mso-char-indent-count: 1.5"><span>通过这个分类，希望你理解，短信是移动增值业务的基础支撑，无论是彩信下载、<span>wap</span>上网、游戏下载都与其有关！<span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><strong style="mso-bidi-font-weight: normal"><span style=" mso-ascii- mso-hansi-">二、</span><span><font face="Times New Roman">SMS</font></span></strong><strong style="mso-bidi-font-weight: normal"><span style=" mso-ascii- mso-hansi-">（</span><span><font face="Times New Roman">Short Messaging Service</font></span></strong><strong style="mso-bidi-font-weight: normal"><span style=" mso-ascii- mso-hansi-">）的体系结构</span><span></span></strong></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><span style="color: black;  letter-spacing: 0.4pt; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-ascii- mso-hansi- mso-bidi-">　　</span><span>GSM</span><span>标准中定义的点<span>-</span>点短消息服务使得短消息能在移动台和短消息服务中心之间传递。这些服务中心是通过称为<span>SMS- GMSC</span>的特定<span>MSC</span>同<span>GSM</span>网络联系的。涉及<span>SMS</span>管理的协议如图一所示。<span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: 18pt; text-align: center; mso-pagination: widow-orphan" align="center"><span style="color: black;  letter-spacing: 0.4pt; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt"></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: 18pt; text-align: center; mso-pagination: widow-orphan" align="center"> </p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: 18pt; text-align: center; mso-pagination: widow-orphan" align="center">
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: 18pt; text-align: center; mso-pagination: widow-orphan" align="center"><span style="color: black;  letter-spacing: 0.4pt; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-ascii- mso-hansi- mso-bidi-">图</span><span style="color: black;  letter-spacing: 0.4pt; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt">1 SMS</span><span style="color: black;  letter-spacing: 0.4pt; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-ascii- mso-hansi- mso-bidi-">管理协议</span><span style="color: black;  letter-spacing: 0.4pt; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt"></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><span style="color: black;  letter-spacing: 0.4pt; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-ascii- mso-hansi- mso-bidi-">　　</span><span>SME</span><span>：<span>Short Messaging Entity</span>，短消息实体。它可以接收或改善短消息，位于固话系统、移动基站或其他服务中心内；<span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><span>　　<span>SMSC</span>：<span>Short Message Service Center</span>，短消息服务中心，负责在基站和<span>SME</span>间中继、储存或转发短消息；移动台（<span>ME</span>）到<span>SMSC</span>的协议能传输来自移动台或朝向移动台的短消息，协议名为<span>SMTP</span>（<span>Short Message Transmission Protocol</span>）；<span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><span>　　<span>SMCGWMS</span>或<span>SMCGMSC</span>：<span>SMS-Gateway MSC</span>，<span>SMS</span>网关。接收由<span>SMSC</span>发送的短消息，向<span>HLR</span>查询路由信息，并将短消息传送给接收者所在基站的交换中心；<span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><span>　　<span>HLR</span>：<span>Home Location Register</span>，归属位置寄存器。用于永久储存管理用户和服务记录的数据库，由<span>SMSC</span>产生。<span>SMS</span>网关与<span>HLR</span>之间的协议使前者可以要求<span>HLR</span>搜索可找到的用户地址。它与<span>MSC</span>与<span>HLR</span>之间的协议一起，能在移动台因超出覆盖区而丢失报文、随后又可找到时加以提示。<span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><span>　　<span>MSC</span>：<span>Mobile Switching Center</span>，移动交换中心。负责系统切换管理并控制来自或发向其他电话或数据系统的拔叫。<span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><span>　　<span>VLR</span>：<span>Visitor Location Register:</span>，访问位置寄存器。含有用户临时信息的数据库。交换中心服务访问用户时需要这些信息。<span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><strong style="mso-bidi-font-weight: normal"><span>重要概念：<span></span></span></strong></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><span>移动起始短消息：<span>Mobile Originated Short Message</span>。<span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><span>　　一个<span>GSM</span>用户发送短消息时，他必须至少在其内容中包含最终地址的识别符，和处理这消息的服务中心号码，然后请求传递。<span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><span>　　短消息的传输要求在移动台和<span>MSC</span>之间建立信令连接。消息本身的传递要求在无线路径上建立专用的链路层链接，并要求采用专用的消息传递协议。在规定的协议栈的顶部是所谓的传输层协议，在移动起始短消息情形下，它是一条单独的报文，即<span>SMTP</span>（不是<span>TCP/IP</span>的<span>SMTP</span>）短消息传送报文，低层处理应答的传送，它只指出<span>SMSC</span>已收到报文。<span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><span>移动终接短消息：<span>Mobile Terminated Short Message</span>。<span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><span>　　目的地为<span>GSM</span>用户的短消息必须首先先从发送方路由至短消息服务中心，然后再被路由至实际地址。<span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><span>　　当<span>SMSC</span>有短消息需发送到期某一<span>GSM</span>用户时，它建立一条包含各种利于接收者的信息的<span>SMS-DELIVER</span>报文。此信息包括用户的内容，最初的发送者身份及用于批示短消息已被<span>SMSC</span>接收的时间标记。与<span>MO</span>情形相似，<span>SMS-DELIVER</span>报文将在各种接口上传送。<span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><span>　　在达到目的地前，报文的实际路由必须利用<span>MAP/C</span>查询功能获得，采用的是如下方法：<span>SMSC</span>将短消息传到与服务中心相连的<span>SMS</span>网关，网关的选择依赖于它想到在的用户，因为通常网关仅能处理某些用户（某家营运商或某个国家的用户）。这样，用户通过目录号（一般同电话一样）来识别，这些目录号最初是由短消息发送者输入的，这使得<span>SMS</span>网关能识别有关的<span>HLR</span>并查询它。查询是通过发送一个专用报文，即用于短消息的<span>MAP/C SEND ROUTING INFOR</span>报文来实现；对其应答既可采用包含用户正在访问的<span>MSC/VLR</span>的<span>SS7</span>地址的<span>MAP/C SEND ROUNTING INFO FOR SHORT MESSAGE RESULT</span>报文，又可当已知用户此时不可到达时采用拒绝报文。<span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><strong style="mso-bidi-font-weight: normal"><span>SMS</span></strong><strong style="mso-bidi-font-weight: normal"><span>由哪些要素组成？<span></span></span></strong></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><span>　　<span>SMS</span>由几个与提交或接收相关的服务要素组成，如：有效期（在将短消息成功送达用户前<span>SMSC</span>需要保证的储存时间），优先性。此外，短消息还提供提交消息的时间、告诉移动台是否还有更多消息要发送，以及还有多少条消息要发送等。<span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><strong style="mso-bidi-font-weight: normal"><span>短消息不可到达的情况有三种：<span></span></span></strong></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><span>　　当被<span>SMS</span>网关查询时，移动台不在服务区域、未获得服务授权、或有未成功发送报文正等待告警，<span>HLR</span>就会立即知道不能发送；<span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; line-height: 18pt; text-align: left; mso-pagination: widow-orphan" align="left"><span>　　第二种情形是，<span>MSC/VLR</span>已收到报文但不能传送的情况。此时，它先向<span>SMS</span>网关发送一故障指示，作为<span>MAP/H FORWARD SHORT MESSAGE</span>报文的应答；然后，网关一方面会向<span>SMSC</span>发送否定报告，另一方面向<span>HLR</span>发送<span>MAP/C SET MESSAGE WAITING DATA</span>报文，在收到报文确认后进行表格更新。该事件会储存在<span>VLR</span>和<span>HLR</span>内的用户记录中；<span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; word-break: break-all; text-indent: 21pt; line-height: 18pt; text-align: left; mso-pagination: widow-orphan; mso-char-indent-count: 2.0" align="left"><span>第三种情况是<span>MSC/VLR</span>向用户发送有效报文后发现不可送达。<span></span></span></p>
<p class="MsoBodyText2" style="margin: 0cm 0cm 0pt"><span style="font-size: 10.5pt;  letter-spacing: 0pt; mso-bidi-font-size: 12.0pt; mso-bidi-font-weight: normal"><strong>三、以移动的ＣＭＰＰ（<span>China Mobile Point to Point</span>）协议为例说明短信的网关协议（中国联通的<span>SGIP</span>（<span>Short Message Gateway Interface Protocol</span>）协议、中国网通的<span>CNGP</span>协议和中国电信的<span>SMGP</span>协议）<span></span></strong></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt"><strong><span><font face="Times New Roman">1</font>、网络结构</span><span></span></strong></p>
<p class="a" style="margin: 0cm 0cm 0pt 21.25pt; "><span style="mso-fareast-"><span style="mso-list: Ignore"><span style="font: 7pt  Times New Roman ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span></p>
<div forimg="1" align="left"><a target="_blank" href="http://hiphotos.baidu.com/dd%5Ftaiyangxue/pic/item/e847a81610192c244b90a71a.jpg">
<div forimg="1" align="center"><img class="blogimg" border="0" small="0" src="http://hiphotos.baidu.com/dd%5Ftaiyangxue/pic/item/74f84df34e8f0636b17ec5e5.jpg"></div>
</a></div>
<p class="a" style="margin: 0cm 0cm 0pt 21.25pt; "> </p>
<p class="a" style="margin: 0cm 0cm 0pt 21.25pt; "><span style="mso-fareast-"><span style="mso-list: Ignore"><span style="font: 7pt  Times New Roman ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style=" mso-ascii- mso-hansi-">图</span><span><font face="Times New Roman">1 </font></span><span style=" mso-ascii- mso-hansi-">互联网短信网关组网结构</span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; text-indent: 21pt; line-height: 150%; text-align: left" align="left"><span>如图<span>1</span>所示，互联网短信网关（<span>ISMG</span>）是业务提供商（<span>SP</span>）与移动网内短信中心之间的中介实体，互联网短信网关一方面负责接收<span>SP</span>发送给移动用户的信息和提交给短信中心。另一方面，移动用户点播<span>SP</span>业务的信息将由短信中心通过互联网短信网关发给<span>SP</span>。另外，为了减轻短信中心的信令负荷，互联网短信网关还应根据路由原则将<span>SP</span>提交的信息转发到相应的互联网短信网关。互联网短信网关通过向汇接网关（<span>GNS</span>）查询的方式获得网关间的转发路由信息。<span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; text-indent: 21pt; line-height: 150%"><span style=" mso-ascii- mso-hansi-">另外，</span><span><font face="Times New Roman">ISMG</font></span><span style=" mso-ascii- mso-hansi-">还必须与数据业务管理平台</span><span><font face="Times New Roman">DSMP</font></span><span style=" mso-ascii- mso-hansi-">进行连接，在业务流程中对用户、业务以及定购关系等进行鉴权并对业务进行批价。</span></p>
</p>
<div forimg="1" align="center"><a target="_blank" href="http://hiphotos.baidu.com/dd%5Ftaiyangxue/pic/item/ee86c6ce635e0a18f9dc611f.jpg">
<div forimg="1" align="center"><img class="blogimg" border="0" small="0" src="http://hiphotos.baidu.com/dd%5Ftaiyangxue/pic/item/327580d2279923253bf3cfe7.jpg"></div>
</a></div>
</span></div></body></html>