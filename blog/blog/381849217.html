<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Linux设置SSH的证书登陆</title><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- top1 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-3347102627476643"
     data-ad-slot="2352128818"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></head><body><h1>Linux设置SSH的证书登陆</h1><div><p>一、新建用户： useradd mytest //passwd mytest</p>
<p>二、su - mytest</p>
<p>三、ssh-keygen -t rsa</p>
<p>Generating public/private rsa key pair.<br>Enter file in which to save the key (/home/mytest/.ssh/id_rsa):&nbsp; <span style="COLOR: #ff0000">使用默认路径</span><br>Created directory '/home/mytest/.ssh'.<br>Enter passphrase (empty for no passphrase): <span style="COLOR: #ff0000">输入密码：123456 (<strong>如果输入为空，则可以实现无密码访问</strong>)</span><br>Enter same passphrase again: <span style="BACKGROUND-COLOR: #ffffff; COLOR: #ff0000">输入密码：123456</span><br>Your identification has been saved in /home/mytest/.ssh/id_rsa.<br>Your public key has been saved in /home/mytest/.ssh/id_rsa.pub.<br>The key fingerprint is:<br>c0:e4:f2:03:c6:2c:86:0d:2b:1b:bc:ca:4c:d6:c6:14 <a href="mailto:mytest@dibin-pc.channel.com">mytest@dibin-pc.channel.com</a></p>
<p>四、cd .ssh/</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cp id_rsa.pub authorized_keys</p>
<p>五、vi id_rsa <span style="COLOR: #ff0000">显示如下内容：</span></p>
<p><span style="COLOR: #ff0000"><span style="COLOR: #404040">-----BEGIN RSA PRIVATE KEY-----</span><br><span style="COLOR: #404040">Proc-Type: 4,ENCRYPTED</span><br><span style="COLOR: #404040">DEK-Info: DES-EDE3-CBC,47888AEC20D07596</span></span></p>
<p><span style="COLOR: #ff0000"><span style="COLOR: #404040">593FuhyXuJYMdd/YFvgsmABtQZfHivcgaQZ5+SY/Sq/+kn3Vxrg7zUeLgnIxf+R4</span><br><span style="COLOR: #404040">1X2t45pbdATIKHg0P8FvefCE06hkmlYbODTlCsGAE1CLBaABYbBZ8O57NL7wgNDh</span><br><span style="COLOR: #404040">NchYfo6MfHUYmXo0t71OS3bTVokcAxjbtNFUj7A2XSYT50/glEQMPmbvsKToFt54</span><br><span style="COLOR: #404040">yds2So/4ZnBVR1AyDfQjFs2KfFjcBqNNSxJkQjBJdWbBwRs6/PSOhS9Tp5iyHZg8</span><br><span style="COLOR: #404040">6AWiz3h8D5wq6HVNL/Hk5V4VO2Tx3TBH+Ea/45QPNEzd0nijrtHzmofdHzafZL52</span><br><span style="COLOR: #404040">OwXE5drGGxeh3o9OgIlNqzUfZaZeyhCjUWdXiuhI7SwmFocCqsPk1qQlfCaPNuld</span><br><span style="COLOR: #404040">Ra9EW+XqNVPCFMbEfxWYG+g55EfHKYrnd2EETIaLoMntqwYOhO4aka6f/i0Wi936</span><br><span style="COLOR: #404040">l48ef11GQKh8elwrmiSs70kAz394Omi6tKgp1QLydSiqtzeDkONH+IxI2tSuHtJc</span><br><span style="COLOR: #404040">liPUHIpgPfoPc70kUH++MldARNcXFx4seiEHEF+VUHPhaiP1kA3GDGpC3rKUUkhK</span><br><span style="COLOR: #404040">QDobdJ+zsm82YOw6KLfP3LFSoR+5gInsc2f/U9SA2+A4RmDHe76stGtW1dZOuosk</span><br><span style="COLOR: #404040">966j5YqTHDeMNZVx4ic1s9N3oH8xBmhl4pnah+KqDtsO/kDsMvZr3Ac7LPGX1hln</span><br><span style="COLOR: #404040">x2SkH6I1EgLh95BzaVDmsp+TNu6ESLeQX01xC8sStkiMhDpePV0Rlnl4Od8Jwlm7</span><br><span style="COLOR: #404040">8ik1BK9ouabdqsBCjCnqmhiJNVJsI29seL5D7Ir640UdIzrIpp09MHjbYZ4QgwuD</span><br><span style="COLOR: #404040">XsHtf/8mjIRHgioGCoBVgJhLhFgjKAj7YDuk4Y6YYY7SiE7iNO205mIHHDeokULt</span><br><span style="COLOR: #404040">2JxwDiC8PJkvRIYjyqRZRQuLkO2Jxw4J2ECkPkfnL1rU6UJmnQ1y7q3yTw5u0cmz</span><br><span style="COLOR: #404040">4O5WMUwj0M2ZDMLo4V3uEa3/3AqmXvtDL1RNiKcSJeJMZXZnjnv4g4zLrq0hT8DE</span><br><span style="COLOR: #404040">9hbVfjmXprz7bkVKXtmCla7oP+0WyeGJvwF7e8Ilu/cy5xtQcMoZnUZ53+eX3x6m</span><br><span style="COLOR: #404040">bhXZgr/PI+dbkzD+MiR5FnM3gpYEkj6rnnJ1wUdnKutYhePeBW7OBCFgrErFWZcW</span><br><span style="COLOR: #404040">1ISoqQT1QjPpKDQivEBV02Y9Qek9+/SxgGG4b//Rn3zM4ahTfPR+iWIHjEUx+CMt</span><br><span style="COLOR: #404040">ecLkffx0OmFdKSJicHe/70BlxckVWNG7jTZ1Y87eD0WoHUkX7gIF5yhz95LN9qpy</span><br><span style="COLOR: #404040">EQbSScRsViYTmKe44l2r80S6iYPOP3d5aUXhdQhu/EW18Y6OD76rb1EB5HsAwfBL</span><br><span style="COLOR: #404040">XfgwIdn07gGUGEG2+7aYC93NKfbyQj+pFUAgvZep/9OztehUfYAGLSIXFJxz9Z9M</span><br><span style="COLOR: #404040">VKu0JN4IVMZ6/f8+42X/5ZNl7LEoAWua8wN99+UYZt9qbkBeSFHYl+ubQY/TC1a+</span><br><span style="COLOR: #404040">b49KwFx7dsBPu7AAuPBnfq0IuHAdcslgJcZVTCi1E1M99df9PEpK9UArjpur47wE</span><br><span style="COLOR: #404040">z+t5oLSa7eHFlmpAnrlaxoM6hReJw/aD2R10wFhL95JCAlhJAbj0KQ==</span><br><span style="COLOR: #404040">-----END RSA PRIVATE KEY-----</span></span></p>
<p><span style="COLOR: #404040">六、拷贝以上内容到windows平台，建立key.txt文件</span></p>
<p><span style="COLOR: #404040">七、设置Xshell登陆</span></p>
<p><span style="COLOR: #404040"><img class="blogimg" border="0" src="http://hiphotos.baidu.com/dd_taiyangxue/pic/item/60ab0f1328f5d597c2fd787b.jpg" small="0"></span></p>
<p><span style="COLOR: #404040"><img class="blogimg" border="0" src="http://hiphotos.baidu.com/dd_taiyangxue/pic/item/4b3a360bdac3aa67b0351d55.jpg" small="0"></span></p>
<p><span style="COLOR: #404040">八、su -</span></p>
<p><span style="COLOR: #404040">&nbsp;&nbsp;&nbsp;&nbsp; vi /etc/ssh/sshd_config</span></p>
<p><span style="COLOR: #404040">去除下面三行前得注视符号：#</span></p>
<p><span style="COLOR: #404040">RSAAuthentication yes<br>PubkeyAuthentication yes<br>AuthorizedKeysFile&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .ssh/authorized_keys<br>修改：PasswordAuthentication yes</span></p>
<p><span style="COLOR: #404040">service sshd restart</span></p>
<p><span style="COLOR: #404040">使用Xshell登陆</span></p>
<p><span style="COLOR: #404040">再次</span><span style="COLOR: #404040">修改：<span style="COLOR: #404040">PasswordAuthentication no</span></span></p>
<p><span style="COLOR: #404040">service sshd restart</span></p>
<p><span style="COLOR: #404040">使用Xshell登陆，ol。<br>九、Linux系统下ssh命令行，证书登陆</span></p>
<p><strong><span style="COLOR: #404040"><span style="FONT-SIZE: 18px">ssh -i /root/.ssh/key.txt&nbsp;</span><a href="mailto:user@ip"><span style="FONT-SIZE: 18px">user@ip</span></a><span style="FONT-SIZE: 18px">地址&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></strong><span style="COLOR: #404040">&nbsp;&nbsp;&nbsp;&nbsp; 其中/root/.ssh/key.txt为密钥地址，-i代表使用本地密钥</span></p>
<p><span style="COLOR: #404040">之后提示输入：Enter passphrase for key '/root/.ssh/key.txt':&nbsp; (<span style="COLOR: #ff0000"><strong>如果输入为空，则可以实现无密码访问</strong>)</span>)</span></p>
<p><span style="COLOR: #404040">十、使用scp无密码拷贝（拷贝test文件夹到指定目录下）</span></p>
<p><strong><span style="COLOR: #404040"><span style="COLOR: #ff0000; FONT-SIZE: 18px">scp&nbsp; -i /root/.ssh/key -r /home/test/&nbsp;</span><a href="mailto:test@ip地址:/home/test"><span style="COLOR: #ff0000; FONT-SIZE: 18px">test@ip地址:/home/test</span></a></span></strong></p>
<p><strong><span style="COLOR: #ff0000; FONT-SIZE: 16px">备注：</span></strong></p>
<p><span style="COLOR: #ff0000; FONT-SIZE: 16px"><span style="BACKGROUND-COLOR: #ffffff; COLOR: #000000">当使用ssh-add 添加新的内容，提示如下错误时：</span><br><span style="BACKGROUND-COLOR: #ffffff; COLOR: #000000">Could not open a connection to your authentication agent.</span><br><span style="BACKGROUND-COLOR: #ffffff; COLOR: #000000">可以通过先运行如下命令：</span></span></p>
<p><span style="COLOR: #ff0000; FONT-SIZE: 16px"><span style="BACKGROUND-COLOR: #ffffff; COLOR: #000000">ssh-agent bash</span><br><span style="BACKGROUND-COLOR: #ffffff; COLOR: #000000">再重新添加</span><br><span style="BACKGROUND-COLOR: #ffffff; COLOR: #000000">ssh-add</span></span></p>
<p><span style="COLOR: #404040"><br><br>&nbsp;</p></span></div></body></html>