<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Kerberos单点登录实现过程</title></head><body><h1>Kerberos单点登录实现过程</h1><div><p style="text-align: center; margin: 0cm 0cm 0pt" class="MsoNormal" align="center"><span style="font-size: small"><font size="2"><span>最近公司在做单点登录的选型，看了看</span><span>Kerberos</span><span>的技术实现。感觉网上</span><span>Kerberos</span><span>的相关资料不多，自己做了总结和大家分享，因为是在选型阶段，没做太深入的学习，学习了</span><span>Kerberos</span><span>的单点登录过程。</span></font></span></p>
<p style="line-height: 150%; margin: 0cm 0cm 7.8pt" class="MsoNormal"><strong><span style="line-height: 150%;  font-size: 12pt">Kerberos</span></strong><strong><span>基本原理</span></strong></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-size: small"><span><font size="2">先转几个链接</font></span></span></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-size: small"><font size="2"><span>1.</span><span>关于理解</span><span>Kerberos</span><span>原理的经典对话，</span><span>MIT</span><span>的人为了帮助人们理解</span><span>Kerberos</span><span>的<span>原理</span>而写的一篇对话集，</span><span>google </span><span>&ldquo;</span><span>Kerberos</span><span>的<span>原理</span>&rdquo;，满篇都是。</span></font></span></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-size: small"><font size="2"><span>2</span><span>．谈谈基于</span><span>Kerberos</span><span>的</span><span>Windows Network Authentication - Part I</span><span>、</span><span>II</span><span>、</span><span>III</span><span>，挺好挺详细的文章，一共三篇，值得一看。</span></font></span></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span><a href="http://www.cnblogs.com/artech/archive/2007/07/05/807492.html"><span style="font-size: small"><font color="#006699" size="2">http://www.cnblogs.com/artech/archive/2007/07/05/807492.html</font></span></a></span></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-size: small"><font size="2"><span>3.</span><span><span> </span></span><span>单点登录</span><span>(SSO)</span><span>的核心－－</span><span>kerberos</span><span>身份认证协议技术参考（一），也是一系列三篇文章</span></font></span></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span><a href="http://chnking.cnblogs.com/archive/2006/03/07/344506.html"><span style="font-size: small"><font color="#006699" size="2">http://chnking.cnblogs.com/archive/2006/03/07/344506.html</font></span></a></span></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span><span style="font-size: small"><font size="2"> </font></span></span></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-size: small"><span><font size="2">下面是自己的原创整理</font></span></span></p>
<p style="line-height: 150%; margin: 0cm 0cm 7.8pt" class="MsoNormal"><strong><span style="line-height: 150%;  font-size: 12pt">Kerberos</span></strong><strong><span>登录过程</span></strong></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-size: small"><span><font size="2">名字解释</font></span></span></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-size: small"><font size="2"><strong><span>KDS</span></strong><strong><span>：</span></strong><span>Kerberos Distribution Center </span><span>认证中心</span></font></span></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-size: small"><font size="2"><strong><span>TGT</span></strong><strong><span>：</span></strong><span>Ticket Granting Ticket </span><span>身份凭证</span></font></span></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-size: small"><font size="2"><strong><span>Master Key</span></strong><strong><span>：</span></strong><span>真正的密钥的</span><span>Hash</span><span>，</span><span>Client</span><span>、</span><span>KDC</span><span>、</span><span>Server</span><span>均有自己的</span><span>Master Key</span></font></span></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-size: small"><font size="2"><strong><span>Session Key</span></strong><strong><span>：</span></strong><span>这种</span><span>Key</span><span>只在一段时间有效，用于加密双方传输的部分数据包</span></font></span></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-size: small"><font size="2"><strong><span>SKDC-Server</span></strong><strong><span>：</span></strong><span>Server</span><span>和</span><span>KDC</span><span>间的</span><span>Session Key</span></font></span></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-size: small"><font size="2"><strong><span>SKDC-Client</span></strong><strong><span>：</span></strong><span>Client</span><span>和</span><span>KDC</span><span>间的</span><span>Session Key</span></font></span></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-size: small"><font size="2"><span><span><img class="blogimg" border="0" small="0" src="http://hiphotos.baidu.com/dd_taiyangxue/pic/item/b0b1864f779a07f3d0c86a1f.jpg"><br>
</span></span></font></span></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"> </p>
<p class="MsoNormal"><strong><span style="line-height: 150%;  font-size: 12pt"><span>1.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span></strong><strong><span style="line-height: 150%;  font-size: 12pt">Authentication Service Exchange</span></strong></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-size: small"><font size="2"><strong><span>这一步骤</span></strong><strong><span>KDC</span></strong><strong><span>实现了对</span></strong><strong><span>Client</span></strong><strong><span>的认证，同时</span></strong><strong><span>KDC</span></strong><strong><span>向</span></strong><strong><span>Client</span></strong><strong><span>颁发了一个</span></strong><strong><span>身份凭证</span></strong><strong><span>TGT</span></strong><strong><span>，</span></strong><strong><span>Client</span></strong><strong><span>可凭此</span></strong><strong><span>TGT</span></strong><strong><span>向</span></strong><strong><span>KDC</span></strong><strong><span>申请用于访问某个</span></strong><strong><span>Server</span></strong><strong><span>的</span></strong><strong><span>Ticket</span></strong><strong><span>。</span></strong></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">1.1.</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>Client</span><span>向</span><span>KDC</span><span>的</span><span>Authentication Service</span><span>服务</span><span>发送</span><span>KRB_AS_REQ</span><span>，目的是申请获取一个用以访问所有</span><span>Server</span><span>的凭证（</span><span>TGT</span><span>）；</span></font></span></p>
<p style="text-indent: 3pt; margin: 0cm 0cm 0pt 25.35pt" class="MsoNormal"><span style="font-size: small"><font size="2"><span>KRB_AS_REQ</span><span>包含：</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">l</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>Pre-authentication data</span><span>：一个被</span><span>Client Master Key</span><span>加密的</span><span>Timestamp</span><span>，用于</span><span>KDC</span><span>验证客户端身份；</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">l</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>Client Info</span><span>：</span><span>Client</span><span>标识，</span><span>KDC</span><span>以此查找</span><span>Client</span><span>的</span><span>Master Key</span><span>；</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">l</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>Server Info</span><span>：此处并不是</span><span>Client</span><span>要访问</span><span>Server</span><span>的</span><span>Server Name</span><span>，实际上是</span><span>KDC</span><span>的</span><span>Ticket Granting Service</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">1.2.</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>AS</span><span>（</span><span>Authentication Service</span><span>服务</span><span>）根据</span><span>Client Info</span><span>从</span><span>KDC</span><span>中提取</span><span>Client Master Key</span><span>，解密</span><span>Pre-authentication data</span><span>，如果</span><span>Timestamp</span><span>合法，则客户端通过验证，因为这个</span><span>Master Key</span><span>仅</span><span>Client</span><span>和</span><span>KDC</span><span>知道；</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">1.3.</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>AS</span><span>将</span><span>KRB_AS_REP</span><span>发送给客户端</span></font></span></p>
<p style="text-indent: 3pt; margin: 0cm 0cm 0pt 25.35pt" class="MsoNormal"><span style="font-size: small"><font size="2"><span>KRB_AS_REP</span><span>包含：</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">l</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>被</span><span>Client Master Key</span><span>加密过的</span></font></span><span>SKDC-Client</span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">l</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>被</span><span>KDC Key</span><span>加密过的</span><span>TGT</span><span>，</span><span>TGT</span><span>（</span></font></span><span>SKDC-Client </span><span style="font-size: small"><font size="2"><span>+ </span><span>Client Info + End Time</span><span>）</span><span>，此</span><span>TGT</span><span>记做</span><span>Client</span><span>的</span><span>TGT</span></font></span></p>
<p class="MsoNormal"><strong><span style="line-height: 150%;  font-size: 12pt"><span>2.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span></strong><strong><span style="line-height: 150%;  font-size: 12pt">KRB_TGT</span></strong></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-size: small"><font size="2"><strong><span>这一步骤</span></strong><strong><span>Client</span></strong><strong><span>获得了</span></strong><strong><span>Server</span></strong><strong><span>的</span></strong><strong><span>TGT</span></strong><strong><span>，此</span></strong><strong><span>TGT</span></strong><strong><span>封装了</span></strong><strong><span>SKDC-Server</span></strong><strong><span>，该</span></strong><strong><span>Session Key</span></strong><strong><span>会用于加密后续步骤中的</span></strong><strong><span>Ticket</span></strong></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">2.1.</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>Client</span><span>接收到</span><span>KRB_AS_REP</span><span>后，使用</span><span>Client Master Key</span><span>对第一部分进行解密，可获得</span><span>SKDC-Client</span><span>，之后向</span><span>Server</span><span>申请获取</span><span>Server</span><span>的</span><span>TGT</span><span>，此</span><span>TGT</span><span>中封装了</span></font></span><span>SKDC-Server</span><span>；</span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">2.2.</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>Server</span><span>将</span><span>KRB_AP_REP</span><span>返回给</span><span>Client</span><span>；</span></font></span></p>
<p style="text-indent: 21pt; margin: 0cm 0cm 0pt 7.35pt" class="MsoNormal"><span style="font-size: small"><font size="2"><span>KRB_AP_REP</span><span>包括：</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">l</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>被</span><span>KDC Key</span><span>加密过的</span><span>TGT</span><span>，</span><span>TGT</span><span>（</span><span>SKDC-Server + Server Info + End Time</span><span>），</span><span>此</span><span>TGT</span><span>记做</span><span>Server</span><span>的</span><span>TGT</span></font></span></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-size: small"><font size="2"><span>注：</span><span>Server</span><span>的</span><span>TGT</span><span>可如同步骤</span><span>1</span><span>由</span><span>Server</span><span>向</span><span>KDC</span><span>申请，并将申请到的</span><span>TGT</span><span>缓存到</span><span>Server</span><span>中。</span><span>Client</span><span>向</span><span>Server</span><span>获取时可直接将其返回，否则需通过</span><span>AS Exchange</span><span>由</span><span>Server</span><span>向</span><span>KDC</span><span>获取。</span></font></span></p>
<p class="MsoNormal"><strong><span style="line-height: 150%;  font-size: 12pt"><span>3.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span></strong><strong><span style="line-height: 150%;  font-size: 12pt">TGS</span></strong><strong><span>（</span></strong><strong><span style="line-height: 150%;  font-size: 12pt">Ticket Granting Service</span></strong><strong><span>）</span></strong><strong><span style="line-height: 150%;  font-size: 12pt">Exchange</span></strong></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-size: small"><font size="2"><strong><span>这一步骤</span></strong><strong><span>Client</span></strong><strong><span>向</span></strong><strong><span>KDC</span></strong><strong><span>提供</span></strong><strong><span>TGT</span></strong><strong><span>，</span></strong><strong><span>KDC</span></strong><strong><span>验证</span></strong><strong><span>TGT</span></strong><strong><span>通过后向</span></strong><strong><span>Client</span></strong><strong><span>颁发访问</span></strong><strong><span>Server</span></strong><strong><span>的</span></strong><strong><span>Ticket</span></strong></font><strong><span style=" font-size: 12pt"> </span></strong></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">3.1.</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>Client</span><span>获得</span><span>Server TGT</span><span>后，</span><span>向</span><span>KDC</span><span>中的</span><span>TGS</span><span>（</span><span>Ticket Granting Service</span><span>）发送</span><span>KRB_TGS_REQ</span><span>，申请用于访问</span><span>Server </span><span>的</span><span>Ticket</span><span>；</span></font></span></p>
<p style="margin: 0cm 0cm 0pt 1cm" class="MsoNormal"><span style="font-size: small"><font size="2"><span>KRB_TGS_REQ</span><span>包含：</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">l</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>Client</span><span>的</span><span>TGT</span><span>：在步骤</span><span>1</span><span>处生成，由</span><span>KDC Master Key</span><span>加密</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">l</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>Server</span><span>的</span><span>TGT</span><span>：在步骤</span><span>2</span><span>处生成，由</span><span>KDC Master Key</span><span>加密</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">l</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>Authenticator</span><span>（</span><span>Client Info +Timestamp</span><span>）</span><span>：用来证明</span><span>Client TGT</span><span>是自己所拥有的，所以需要用</span><span>SKDC</span><span>&mdash;</span><span>Client</span><span>加密</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">l</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>Client Info</span><span>：</span><span>Client</span><span>标识</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">l</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>Server Info:</span><span> </span><span>Client</span><span>试图访问的那个</span><span>Server</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">3.2.</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>KDC</span><span>先用</span><span>KDC Master Key</span><span>解密</span><span>Client</span><span>的</span><span>TGT</span><span>，获得</span><span>SKDC-Client</span><span>；</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">3.3.</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>使用</span><span>SKDC</span><span>&mdash;</span><span>Client</span><span>解密</span><span>Authenticator</span><span>，通过比对</span><span>3.2</span><span>和</span><span>3.3</span><span>步骤中分别获得的</span><span>Client Info</span><span>可验证发送者是否是</span><span>Client TGT</span><span>的真正拥有者；</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">3.4.</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>KDC</span><span>再用</span><span>KDC Master Key</span><span>解密</span><span>Server</span><span>的</span><span>TGT</span><span>获得</span><span>SKDC-Server</span><span>；</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">3.5.</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>验证通过后，向</span><span>Client</span><span>发送</span></font></span><span>KRB_TGS_REP</span></p>
<p style="text-indent: 21pt; margin: 0cm 0cm 0pt 7.35pt" class="MsoNormal"><span>KRB_TGS_REP</span><span style="font-size: small"><font size="2"><span> </span><span>包含：</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">l</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>使用</span><span>SKDC-Client</span><span>加密的</span><span>SServer-Client</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">l</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>使用</span><span>SKDC-Server</span><span>加密的</span><span>Session Ticket</span><span>，该</span><span>Ticket</span><span>中包括</span><span>SServer-Client</span><span>、</span><span>Client name</span><span>、</span><span>End Time</span><span>（</span><span>Ticket</span><span>到期时间）</span></font></span></p>
<p class="MsoNormal"><strong><span style="line-height: 150%;  font-size: 12pt"><span>4.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span></strong><strong><span style="line-height: 150%;  font-size: 12pt">CS</span></strong><strong><span>（</span></strong><strong><span style="line-height: 150%;  font-size: 12pt">Client/Server </span></strong><strong><span>）</span></strong><strong><span style="line-height: 150%;  font-size: 12pt">Exchange</span></strong></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-size: small"><font size="2"><strong><span>Client</span></strong><strong><span>接收到</span></strong></font></span><strong><span>KRB_TGS_REP</span></strong><span style="font-size: small"><font size="2"><strong><span> </span></strong><strong><span>后，使用</span></strong><strong><span>SKDC-Client</span></strong><strong><span>解密可获得</span></strong><strong><span>SServer-Client</span></strong><strong><span>，有了</span></strong><strong><span>SServer-Client</span></strong><strong><span>和</span></strong><strong><span>Ticket</span></strong><strong><span>，</span></strong><strong><span>Client</span></strong><strong><span>就可以与</span></strong><strong><span>Server</span></strong><strong><span>进行交互而无需通过</span></strong><strong><span>KDC</span></strong><strong><span>。</span></strong></font></span></p>
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-size: small"><font size="2"><strong><span>这一步骤完成了</span></strong><strong><span>Server</span></strong><strong><span>对</span></strong><strong><span>Client</span></strong><strong><span>的认证。</span></strong></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">4.1.</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>Client</span><span>接收到</span><span>KRB_TGS_REP</span><span>后，使用</span><span>SKDC-Client</span><span>对</span><span>第一部分解密可获得</span><span>SServer-Client</span><span>，随后创建</span></font></span><span>Authenticator</span><span>并使用</span><span style="font-size: small"><font size="2"><span>SServer-Client</span><span>加密</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">4.2.</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span>Client</span><span style="font-size: small"><font size="2"><span>向</span><span>Server</span><span>发送</span><span>KRB_AP_REQ </span></font></span></p>
<p style="text-indent: 7.35pt; margin: 0cm 0cm 0pt 21pt" class="MsoNormal"><span style="font-size: small"><font size="2"><span>KRB_AP_REQ</span><span>包含内容：</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">l</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>Session Ticket</span><span>（</span><span>Client Info + SServer-Client+ End Time</span><span>）</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">l</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>Authenticator </span><span>（</span><span>Client Info + Timestamp</span><span>）</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">l</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>是否需要进行双向验证的</span><span>Flag</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">4.3.</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>Server</span><span>使用</span><span>SKDC-Server</span><span>解密</span><span>Ticket</span><span>获得</span><span> SServer-Client</span><span>；</span></font></span></p>
<p class="MsoNormal"><span><span><span style="font-size: small"><font size="2">4.4.</font></span><span>&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></span><span style="font-size: small"><font size="2"><span>使用</span><span>SServer-Client</span><span>解密</span><span>Authenticator</span><span>，通过比较</span><span>Authenticator</span><span>中的</span><span>Client Info</span><span>和</span><span>Ticket</span><span>中的</span><span>Client Info</span><span>实现对</span><span>Client</span><span>的验证</span><span>。</span><span> </span></font></span></p></div></body></html>